# editorConfig
在项目中引入 editorconfig 是为了在多人协作开发中保持代码的风格和一致性。不同的开发者使用不同的编辑器或IDE，可能会有不同的缩进（比如有的人喜欢4个空格，有的喜欢2个空格）、换行符、编码格式等。甚至相同的编辑器因为开发者自定义配置的不同也会导致不同风格的代码，这会导致代码的可读性降低，增加代码冲突的可能性，降低了代码的可维护性。

EditorConfig 使**不同编辑器**可以保持同样的配置。因此，我们得以无需在每次编写新代码时，再依靠 Prettier 来按照团队约定格式化一遍（出现保存时格式化突然改变的情况） 。当然这需要在你的 IDE 上安装了必要的 EditorConfig 插件或扩展。


## 安装editorConfig插件

### 添加到工作区建议
然后在插件的介绍页上点击设置的齿轮，并且选择Add to Workspace Recommendations，就可以将其加入清单。也可以直接开启 .vscode/extensions.json 进行编辑：


向团队每一位成员建议安装此插件
eslint与prettier我们也进行这一配置


```json
// .vscode/extensions.json
{
    "recommendations": [
        "editorconfig.editorconfig",
        "dbaeumer.vscode-eslint",
        "esbenp.prettier-vscode"
    ]
}
```

### 在根目录新建.editorconfig
```ini
# https://editorconfig.org
root = true # 设置为true表示根目录，控制配置文件 .editorconfig 是否生效的字段

[*] # 匹配全部文件，匹配除了 `/` 路径分隔符之外的任意字符串
charset = utf-8                  # 设置字符编码，取值为 latin1，utf-8，utf-8-bom，utf-16be 和 utf-16le，当然 utf-8-bom 不推荐使用
end_of_line = lf                 # 设置使用的换行符，取值为 lf，cr 或者 crlf
indent_size = 2                  # 设置缩进的大小，即缩进的列数，当 indexstyle 取值 tab 时，indentsize 会使用 tab_width 的值
indent_style = space             # 缩进风格，可选space｜tab
insert_final_newline = true      # 设为true表示使文件以一个空白行结尾
trim_trailing_whitespace = true  # 删除一行中的前后空格

[*.md] # 匹配全部 .md 文件
trim_trailing_whitespace = false
```


可以规范本项目中文件的缩进风格，和缩进空格数等，会覆盖 vscode 的配置，来达到不同编辑器中代码默认行为一致的作用。
VS Code 的 EditorConfig 目前支持下列属性：

indent_style
indent_size
tab_width
end_of_line(on save)
insert_final_newline(on save)
trim_trailing_whitespace(on save)



# eslint

关注代码质量，检查代码风格

ESLint 是什么呢？一个开源的 JavaScript 的 linting 工具，是一个在 JavaScript 代码中通过规则模式匹配作代码识别和报告的插件化的检测工具，它的目的是保证代码规范的一致性和及时发现代码问题、提前避免错误发生。它使用 espree 将 JavaScript 代码解析成抽象语法树 (AST)，然后通过AST 来分析我们代码，从而给予我们两种提示：

代码质量问题：使用方式有可能有问题，eslint 可以发现代码中存在的可能错误，如使用未声明变量、声明而未使用的变量、修改 const 变量、代码中使用debugger等等
代码风格问题：风格不符合一定规则，eslint 也可以用来统一团队的代码风格，比如加不加分号、使用 tab 还是空格、字符串使用单引号 等等


```
npm i -D eslint eslint-plugin-react-hooks eslint-plugin-react-refresh @typescript-eslint/parser @typescript-eslint/parser                   

```

需要告诉 eslint 使用的 react版本，在 .eslintrc.js 和rules 平级添加 settings 配置，让 eslint 自己检测 react 版本，

```js 
// .eslintrc.cjs
module.exports = {
  root: true,
  env: { browser: true, es2020: true },
  extends: [
    'eslint:recommended',
    'plugin:@typescript-eslint/recommended',
    'plugin:react-hooks/recommended',
  ],
  ignorePatterns: ['dist', '.eslintrc.cjs'],
  parser: '@typescript-eslint/parser',
  plugins: ['react-refresh'],
  rules: {
    'react-refresh/only-export-components': [
      'warn',
      { allowConstantExport: true },
    ],
  },
  settings: {
  "react": {
     "version": "detect"
  }
  }
}

```


## 增加.eslintignore
```
node_modules
dist
env
.gitignore
pnpm-lock.yaml
README.md
src/assets/*

```

## 增加eslint检测脚本

```ini
// --fix：此项指示 ESLint 尝试修复尽可能多的问题。这些修复是对实际文件本身进行的，只有剩余的未修复的问题才会被输出。
"lint:eslint": "eslint --fix --ext .js,.ts,.tsx ./src",
```
# prettier
```
npm i -D prettier
```

vscode 安装 prettier插件
其实安装完插件已经具有prettier的能力了
关键是项目中需要有统一配置


```js
// .prettierrc.js
module.exports = {
  tabWidth: 2, // 一个tab代表几个空格数，默认就是2
  useTabs: false, // 是否启用tab取代空格符缩进，.editorconfig设置空格缩进，所以设置为false
  printWidth: 100, // 一行的字符数，如果超过会进行换行
  semi: false, // 行尾是否使用分号，默认为true
  singleQuote: true, // 字符串是否使用单引号
  trailingComma: 'none', // 对象或数组末尾是否添加逗号 none| es5| all
  jsxSingleQuote: true, // 在jsx里是否使用单引号，你看着办
  bracketSpacing: true, // 对象大括号直接是否有空格，默认为true，效果：{ foo: bar }
  arrowParens: 'avoid' // 箭头函数如果只有一个参数则省略括号
}

```


```
// .prettierignore
node_modules
dist
env
.gitignore
pnpm-lock.yaml
README.md
```

## 配置.vscode/settings.json
配置前两步后，虽然已经配置 prettier 格式化规则，但还需要让 vscode 来支持保存后触发格式化，在项目根目录新建 .vscode 文件夹，内部新建 settings.json 文件配置文件，代码如下：


```json
{
  "search.exclude": {
    "/node_modules": true,
    "dist": true,
    "pnpm-lock.yaml": true
  },
  "files.autoSave": "onFocusChange",
  "editor.formatOnSave": true,
  "editor.formatOnType": true,
  "editor.defaultFormatter": "esbenp.prettier-vscode",
  "[javascript]": {
    "editor.defaultFormatter": "esbenp.prettier-vscode"
  },
  "[javascriptreact]": {
    "editor.defaultFormatter": "esbenp.prettier-vscode"
  },
  "[typescript]": {
    "editor.defaultFormatter": "esbenp.prettier-vscode"
  },
  "[typescriptreact]": {
    "editor.defaultFormatter": "esbenp.prettier-vscode"
  },
  "[json]": {
    "editor.defaultFormatter": "vscode.json-language-features"
  },
  "[html]": {
    "editor.defaultFormatter": "esbenp.prettier-vscode"
  },
  "[markdown]": {
    "editor.defaultFormatter": "esbenp.prettier-vscode"
  },
  "javascript.validate.enable": false,
}


```


## 增加prettier脚本

```
"lint:prettier": "prettier --write --loglevel warn \"src/**/*.{js,ts,json,tsx,css,less,scss,stylus,html,md}\""

```

"--write": 表示将格式化后的结果直接写回原文件中，而不是输出到控制台。
"--loglevel warn": 表示只输出警告级别的日志信息。
"src/**/*.{js,ts,json,tsx,css,less,scss,stylus,html,md}": 是要格式化的文件的路径，这里指定了在 **src** 目录下，所有扩展名为 .js、.ts、.json、.tsx、.css、.less、.scss、.stylus、.html、.md 的文件。



# 解决eslint与prettier冲突
安装依赖
```
pnpm add eslint-config-prettier eslint-plugin-prettier -D

```

在 .eslintrc.js 的 extends 中加入：
```
  extends: [
    // ...
    'plugin:prettier/recommended', // <==== 增加一行
  ],
```

最后再配置一下 .vscode/settings.json


# 安装markdownlint

```
pnpm add markdownlint-cli -D
```

## 新建.markdownlint.js
```js
module.exports = {
  default: false, // excludes all rules
  MD001: true, // enables rule MD001
  MD003: { style: 'atx_closed' }, // set parameter style of rule MD003 to atx_closed
  'first-line-heading': true, // enables alias first-line-heading
  atx_closed: true // enables tag atx-closed
}

```
名称可以是default、 rule、 alias 或 tags：

default：特殊属性，设为 true 会启用所有规则，反之设为 false 则关闭所有规则
rule：规则名称，对应至各个规则，像是范例中的 MD001 与MD003
alias：规则别称，对应至各个规则的别名，例如范例中的 first-line-heading 是规则 MD041 的别名
tags：作用的标签，对应至各规则的所属标签，可以将其视为规则的群组，例如范例中的 atx_closed 包括了 MD020 与 MD021 两个规则

## 新建 .markdownlintignore
```
node_modules
dist
env
.gitignore
pnpm-lock.yaml
src/assets/*
.vscode
public
.github

```

## 加入scripts
```
    "lint:md": "markdownlint --config .markdownlint.js --fix ."
```

## 配置.vscode/settings.json
```
{ 
    // ...
    "editor.codeActionsOnSave": { 
        "source.fixAll.markdownlint": true 
    } 
}

```

作者：_你当像鸟飞往你的山
链接：https://juejin.cn/post/7207374216126922809
来源：稀土掘金
著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。
